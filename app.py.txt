import streamlit as st
import pandas as pd
from googleapiclient.discovery import build

# -------------------------------
# YouTube API ayarlarÄ±
# -------------------------------
API_KEY = 
API_SERVICE_NAME = "youtube"
API_VERSION = "v3"

# YouTube API servisini baÅŸlat
youtube = build(API_SERVICE_NAME, API_VERSION, developerKey=API_KEY)

# -------------------------------
# Streamlit arayÃ¼z
# -------------------------------
st.set_page_config(page_title="YouTube Trend Analizi", page_icon="ğŸ“Š", layout="wide")
st.title("ğŸ“Š YouTube Trend Analizi")

# KullanÄ±cÄ±dan arama kelimesi al
query = st.text_input("Arama terimi gir:", value="python tutorial")

# VideolarÄ± Ã§ek
if st.button("Ara"):
    request = youtube.search().list(
        q=query,
        part="snippet",
        type="video",
        order="viewCount",
        maxResults=10
    )
    response = request.execute()

    # SonuÃ§larÄ± DataFrame'e dÃ¶nÃ¼ÅŸtÃ¼r
    videos = []
    for item in response.get("items", []):
        videos.append({
            "BaÅŸlÄ±k": item["snippet"]["title"],
            "Kanal": item["snippet"]["channelTitle"],
            "YayÄ±n Tarihi": item["snippet"]["publishedAt"],
            "Video Linki": f"https://www.youtube.com/watch?v={item['id']['videoId']}"
        })

    df = pd.DataFrame(videos)
    st.dataframe(df)

    # Ä°ndirme butonu
    csv = df.to_csv(index=False).encode('utf-8')
    st.download_button("ğŸ“¥ CSV olarak indir", csv, "youtube_trends.csv", "text/csv")


